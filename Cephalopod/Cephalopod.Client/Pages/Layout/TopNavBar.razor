@inject ITranslator Translator
@inject IAuthenticationService AuthenticationService
@inject IAuthenticationNotify AuthenticationNotify
@inject ICacheService CacheService
@inject IDialogService DialogService

<MudAppBar Color="Color.Primary" Fixed="true">
    <MudIconButton Icon="@Icons.Material.Rounded.MoreVert" Color="Color.Inherit" />

    <MudSpacer />


    <MudMenu Dense="true"
             Variant="Variant.Text"
             Size="Size.Medium"
             Color="Color.Inherit"
             Icon="@Icons.Material.Rounded.AccountCircle">

        <MudMenuItem Href="#"
                     Icon="@Icons.Material.TwoTone.Person"
                     IconColor="Color.Primary"
                     Label="@_name" />

        <MudDivider />

        <MudMenu StartIcon="@Icons.Material.TwoTone.Settings"
                 IconColor="Color.Primary"
                 Label="Settings">
            <MudMenuItem Icon="@Icons.Material.TwoTone.DarkMode"
                         IconColor="Color.Secondary"
                         Label="Dark Theme" />
        </MudMenu>


        <MudMenuItem OnClick="_ => ShowDialog()"
                     Icon="@Icons.Material.TwoTone.ExitToApp"
                     IconColor="Color.Primary"
                     Label="@Translator["Logout"]" />
    </MudMenu>
</MudAppBar>

@code {
    private string? _name;

    protected override async Task OnInitializedAsync()
    {
        _name = await AuthenticationService.GetUsername();
    }

    private async Task ShowDialog()
    {
        var options = new DialogOptions
        {
            MaxWidth = MaxWidth.ExtraSmall,
            FullWidth = true
        };

        await DialogService.ShowAsync<LogoutDialog>(null, options);
    }

}
